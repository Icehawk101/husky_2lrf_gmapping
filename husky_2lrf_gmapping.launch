<launch>
	<machine name="husky" address="192.168.1.100" env-loader="/opt/ros/hydro/env.sh" user="Nick" />

	<include machine="husky" file="$(find husky_base)/launch/base.launch" respawn="true" />

	<include file="$(find husky_teleop)/launch/teleop.launch"respawn="true" />

	<node machine="husky" pkg="husky_base" type="basic_odom_publisher" name="dead_reckoning" />

	<!-- <node pkg="um6" type="um6_driver" name="um6_driver" respawn="true"> -->
    	<!-- 	<param name="port" type="string" value="/dev/ttyUSB1"/> -->
	<!--	<param name="mag_updates" type="bool" value="false"/> -->
  	<!--  </node> -->

  	<node machine="husky" pkg="tf" type="static_transform_publisher" name="imu_tf" args="0 0 0 0 0 0 base_link imu_link 10"/>

	<include machine="husky" file="$(find husky_description)/launch/description.launch"/>

	<node machine="husky" pkg="robot_pose_ekf" type="robot_pose_ekf" name="robot_pose_ekf">
		<remap from="odom" to="encoder"/>
		<remap from="imu_data" to="imu/data"/>
    		<param name="output_frame" value="odom"/>
    		<param name="freq" value="30.0"/>
    		<param name="sensor_timeout" value="1.0"/>
    		<param name="odom_used" value="true"/>
    		<param name="imu_used" value="false"/>
    		<param name="vo_used" value="false"/>
    		<param name="debug" value="false"/>
    		<param name="self_diagnose" value="false"/>
		<remap from="/robot_pose_ekf/odom" to="odom" />
  	</node>

	<node machine="husky" pkg="tf" type="static_transform_publisher" name="front_laser_tf" args="0.333 0 0.626 0 0 0 base_link front_laser 40"/>

	<node machine="husky" pkg="tf" type="static_transform_publisher" name="rear_laser_tf" args="-0.333 0 0.626 3.142 0 0 base_link rear_laser 40"/>

	<node machine="husky" pkg="LMS1xx" type="LMS100" name="front_laser" respawn="true">
		<remap from="/front_laser/scan" to="scan"/>
		<param name="host" value="192.168.1.2"/>
		<param name="frame_id" value="front_laser"/>
	</node>

	<node machine="husky" pkg="LMS1xx" type="LMS100" name="rear_laser" respawn="true">
		<remap from="/rear_laser/scan" to="scan"/>
		<param name="host" value="192.168.1.3"/>
		<param name="frame_id" value="rear_laser"/>
	</node>

	<node machine="husky" pkg="gmapping" type="slam_gmapping" name="gmap"/>

	<node pkg="rviz" type="rviz" name="rviz" args="-d $(find husky_2lrf_gmapping)/rviz/2lrf.rviz"/>
</launch>
