<launch>
	<include file="$(find husky_base)/launch/base.launch">
		<args name="port" value="/dev/ttyUSB0"/>
	</include>

	<include file="$(find husky_teleop)/launch/teleop.launch"/>

	<node pkg="um6" type="um6_driver" name="um6_driver">
    		<param name="port" type="string" value="/dev/ttyUSB1"/>
    		<param name="mag_updates" type="bool" value="false"/>
  	</node>

  	<node pkg="tf" type="static_transform_publisher" name="imu_tf" args="0 0 0 0 0 0 base_link imu_link 10"/>

	<include file="$(find husky_description)/launch/description.launch"/>

	<node pkg="robot_pose_ekf" type="robot_pose_ekf" name="robot_pose_ekf">
		<remap from="odom" to="husky_basic_odom"/>
		<remap from="imu_data" to="imu/data"/>
    		<param name="output_frame" value="odom"/>
    		<param name="freq" value="30.0"/>
    		<param name="sensor_timeout" value="1.0"/>
    		<param name="odom_used" value="true"/>
    		<param name="imu_used" value="true"/>
    		<param name="vo_used" value="false"/>
    		<param name="debug" value="false"/>
    		<param name="self_diagnose" value="false"/>
  	</node>

	<node pkg="LMS1xx" type="LMS100" name="front_laser" respawn="true">
		<remap from="scan" to="base_scan"/>
	</node>

	<node pkg="tf" type="static_transform_publisher" name="front_laser_tf" args="0.333 0 0.626 0 0 0 base_link front_laser 40"/>

	<node pkg="LMS1xx" type="LMS100" name="rear_laser" respawn="true">
		<remap from="scan" to="base_scan"/>
	</node>

	<node pkg="tf" type="static_transform_publisher" name="rear_laser_tf" args="-0.333 0 0.626 3.142 0 0 base_link rear_laser 40"/>

	<node pkg="gmapping" type="slam_gmapping" scan="base_scan" name="gmap"/>

	<node pkg="rviz" type="rviz" name="rviz"/>
</launch>
